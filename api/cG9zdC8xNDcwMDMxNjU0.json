{"title":"Android开发之Intent及IntentFilter的探究学习","date":"2016-08-01T06:07:34.000Z","date_formatted":{"ll":"2016年8月1日","L":"2016/08/01","MM-DD":"08-01"},"link":"post/1470031654","comments":true,"categories":["Android"],"updated":"2021-01-14T08:08:54.897Z","content":"<p>Intent在android开发过程中再熟悉不过了，调用系统相机，调用系统电话，页面跳转，数据传递…其实这些都是基本的，也是在开发过程中用到最多的，但是更深一层你又知道多少呢，所以还是总结一下吧，日后顺手拈来。</p>\n<a id=\"more\"></a>\n<h2 id=\"什么是intent\">什么是Intent<a title=\"#什么是intent\" href=\"#什么是intent\"></a></h2>\n<p>Intent在字面意思是指“意图”，在安卓开发中担任着启动某个组件和组件之间通信传递数据的重要角色。IntentFilter作为“意图”过滤器，其主要作用负责过滤掉组件无法响应和处理的Intent，只将自己关心的Intent接收进来进行处理，一个被启动的组件可以有多个IntentFilter,每个IntentFilter相互独立，使用时只要其中一个过滤器验证通过即可，除了广播可在代码中注册过滤器，其他组件必须AndroidManifest.xml文件中进行声明。</p>\n<h2 id=\"intent&amp;intentfilter属性\">Intent&amp;IntentFilter属性<a title=\"#intent&amp;intentfilter属性\" href=\"#intent&amp;intentfilter属性\"></a></h2>\n<p>Intent对象大致可包含Component、Action、Category、Data、Type、Extra和Flag这7种属性。<br>\nIntentFilter包含Action,Category,Data这三种属性。</p>\n<h2 id=\"意图分类\">意图分类<a title=\"#意图分类\" href=\"#意图分类\"></a></h2>\n<p>“意图”分为显式意图和隐式意图。</p>\n<h3 id=\"显式intent\">显式Intent<a title=\"#显式intent\" href=\"#显式intent\"></a></h3>\n<p>显式Intent是指从表面上明确看出启动某个组件，包括包名和类名。另外强调，从安卓5.0以后启动service必须采用显式Intent方式来启动。</p>\n<ol>\n<li>\n<p>可采用intent七个属性中的Component属性，需要接受一个ComponentName类，里面有三个构造函数，其本质都是一样，指定包名和类名来确定一个组件。</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">ComponentName componentName = <span class=\"keyword\">new</span> ComponentName(<span class=\"string\">&quot;com.example.apptest&quot;</span>,<span class=\"string\">&quot;com.example.apptest.SecondActivity&quot;</span>);</span><br><span class=\"line\">intent.setComponent(componentName);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n<p>注意后边的类名，一定要把整个路径写全。</p>\n</li>\n<li>\n<p>可采用Intent的setClass、setClassName等方法也能确定启动某个组件，和Component用法一样。</p>\n</li>\n</ol>\n<p>其实上边1和2的方式如果在同一个app下都可简化成：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(MainActivity.<span class=\"keyword\">this</span>,SecondActivity.class);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n<h3 id=\"隐式intent\">隐式Intent<a title=\"#隐式intent\" href=\"#隐式intent\"></a></h3>\n<p>凡是不能从表面明确看出到底启动的是哪个组件，都属于隐式Intent，配合IntentFilter一起使用。</p>\n<ol>\n<li>\n<p>Action,Category属性与IntentFilter配置。<br>\n前边已经说过，IntentFilter中有三个属性，其中Action、Category其实就是一个普通的字符串，Action代表该Intent所有完成的一个“动作”，Category则用于为Action增加额外的附加类信息。通常两个是结合着使用的。</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setAction(<span class=\"string\">&quot;com.example.apptest.goto&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n<p>上边隐式启动另一个Activity，其实默认隐藏了intent.addCategory(“android.intent.category.DEFAULT”)这个句。所以AndroidManifest.xml文件中进行声明：</p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;intent-filter&gt;</span><br><span class=\"line\">    &lt;action android:name=<span class=\"string\">&quot;com.example.apptest.goto&quot;</span>/&gt;</span><br><span class=\"line\">    &lt;category android:name = <span class=\"string\">&quot;android.intent.category.DEFAULT&quot;</span>  /&gt;</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n<p>一个intent对象只能设置一个action，可以设置多个category，一个intentFilter可以设置多个action,多个category，并且至少要有一个<code>&lt;category android:name = &quot;android.intent.category.DEFAULT&quot;/&gt;</code>属性。</p>\n</li>\n<li>\n<p>Data,Type属性与IntentFilter配置。<br>\nData属性通常用于向Action属性提供操作的数据，Data接受的是一个Uri对象，Uri格式包含四个部分：scheme、host、port、path，例如：<code>run://www.example.com:8080/index</code>，其中的scheme就是<code>run</code>，host就是<code>www.example.com</code>，port就是<code>8080</code>，path就是<code>/index</code>。</p>\n<p>Data和Tyep属性在添加的时候很特别，如果intent先设置了Data属性将覆盖Type属性(过滤器将不会过滤type属性)，如果intent先设置了Type属性将覆盖Data属性(过滤器中将不会过滤data属性)，如果两个都想设置，则应该调用intent的setDataAndType()方法。</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setAction(<span class=\"string\">&quot;com.example.apptest.goto&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//intent.setType(&quot;run/gege&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">//intent.setData(Uri.parse(&quot;http://www.example.com:8080/index&quot;));</span></span><br><span class=\"line\">intent.setDataAndType(Uri.parse(<span class=\"string\">&quot;http://www.example.com:8080/index&quot;</span>),<span class=\"string\">&quot;run/gege&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n<p>在过滤器里设置type属性是包含在data属性里面的：</p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;intent-filter&gt;</span><br><span class=\"line\">    &lt;action android:name=<span class=\"string\">&quot;com.example.apptest.goto&quot;</span>/&gt;</span><br><span class=\"line\">    &lt;category android:name = <span class=\"string\">&quot;android.intent.category.DEFAULT&quot;</span>  /&gt;</span><br><span class=\"line\">    &lt;data android:mimeType=<span class=\"string\">&quot;run/gege&quot;</span></span><br><span class=\"line\">        android:scheme=<span class=\"string\">&quot;http&quot;</span></span><br><span class=\"line\">        android:host=<span class=\"string\">&quot;www.example.com&quot;</span></span><br><span class=\"line\">        android:port=<span class=\"string\">&quot;8080&quot;</span></span><br><span class=\"line\">        android:path=<span class=\"string\">&quot;/index&quot;</span>/&gt;</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n<p>特殊说明：如果在过滤器中没有指定<code>android:host</code>属性，那么后边的<code>android:port</code>、<code>android:path</code>元素即使intent指明了也不会起作用的。</p>\n</li>\n</ol>\n<h2 id=\"intent使用\">Intent使用<a title=\"#intent使用\" href=\"#intent使用\"></a></h2>\n<p>目前我们所接触的intent能够启动三种组件：Activity、Service、BroadcastRecever。除了常规项目开发中显式或者隐式的启动本应用的一个组件外，intent还常常用来启动系统组件，另外intent还可设置Extra属性用于在多个组件之间进行数据传值和数据交换，还可设置Flag属性用于控制组件启动方式和一些动态指令。</p>\n<p>Android内部提供了大量标准的Action和Category常量。<br>\n其中用于启动Activity的标准Aciton及对应的字符串如下表所示：<br>\n<img src=\"https://note.youdao.com/yws/api/personal/file/363B7D9A6B574D74A41D55C4A63F0F66?method=download&amp;shareKey=b8b0532be06dce0b06f59a9945bc2a0b\" alt=\"启动Activity的标准Aciton\"></p>\n<p>其中用于启动Activity的标准Category及对应的字符串如下表所示：<br>\n<img src=\"https://note.youdao.com/yws/api/personal/file/A43462330DC540F8AF8F33089BED0EF5?method=download&amp;shareKey=0a2dab3026e766466aad252172bfc9c7\" alt=\"启动Activity的标准Category\"></p>\n<h2 id=\"intent调用系统组件使用例子\">Intent调用系统组件使用例子<a title=\"#intent调用系统组件使用例子\" href=\"#intent调用系统组件使用例子\"></a></h2>\n<ol>\n<li>安装已经存在的apk <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String filePath=<span class=\"string\">&quot;mnt/sdcard/abc.apk&quot;</span>;</span><br><span class=\"line\">Intent intent = <span class=\"keyword\">new</span>  Intent(Intent.ACTION_VIEW);</span><br><span class=\"line\">intent.setDataAndType(Uri.parse(<span class=\"string\">&quot;file://&quot;</span> + filePath),<span class=\"string\">&quot;application/vnd.android.package-archive&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>卸载某个应用 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String packageName=<span class=\"string\">&quot;org.adw.launcher2&quot;</span> <span class=\"comment\">//包名，指定该应用</span></span><br><span class=\"line\">Uri packageUri = Uri.parse(<span class=\"string\">&quot;package:&quot;</span>+packageName);</span><br><span class=\"line\">Intent uninstallIntent = <span class=\"keyword\">new</span> Intent(Intent.ACTION_DELETE, packageUri);</span><br><span class=\"line\">startActivity(uninstallIntent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>查看某个应用的信息 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Uri uri=Uri.parse(<span class=\"string\">&quot;package:&quot;</span>+packageName);<span class=\"comment\">//包名，指定该应用</span></span><br><span class=\"line\">Intent intent=<span class=\"keyword\">new</span> Intent(<span class=\"string\">&quot;android.settings.APPLICATION_DETAILS_SETTINGS&quot;</span>, uri);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>浏览某个网址 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Uri uri = Uri.parse(<span class=\"string\">&quot;http://xxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>);  </span><br><span class=\"line\">Intent intent   = <span class=\"keyword\">new</span> Intent(Intent.ACTION_VIEW,uri);</span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.browser&quot;</span>, <span class=\"string\">&quot;com.android.browser.BrowserActivity&quot;</span>);  <span class=\"comment\">//用系统浏览器打开网页</span></span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统设置界面 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent=<span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.settings&quot;</span>,<span class=\"string\">&quot;com.android.settings.Settings&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>回到桌面 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(Intent.ACTION_MAIN);</span><br><span class=\"line\">intent.addCategory(Intent.CATEGORY_HOME);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统拨号界面 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent= <span class=\"keyword\">new</span> Intent(Intent.ACTION_DIAL);  </span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.contacts&quot;</span>,<span class=\"string\">&quot;com.android.contacts.DialtactsActivity&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统通话记录界面 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent =<span class=\"keyword\">new</span> Intent(); </span><br><span class=\"line\">intent.setAction(<span class=\"string\">&quot;android.intent.action.CALL_BUTTON&quot;</span>); </span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统拨号界面拨打电话 <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Uri uri = Uri.parse(<span class=\"string\">&quot;tel:xxxxxx&quot;</span>);   </span><br><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(Intent.ACTION_DIAL, uri);      </span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>直接拨打电话<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intentPhone = <span class=\"keyword\">new</span> Intent(Intent.ACTION_CALL, Uri.parse(<span class=\"string\">&quot;tel:&quot;</span> + phoneNumber));</span><br><span class=\"line\">startActivity(intentPhone);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统联系人界面<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.contacts&quot;</span>,<span class=\"string\">&quot;com.android.contacts.activities.PeopleActivity&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到系统搜索界面<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent=<span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.quicksearchbox&quot;</span>, <span class=\"string\">&quot;com.android.quicksearchbox.SearchActivity&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到短信收件箱界面<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent();</span><br><span class=\"line\">intent.setClassName(<span class=\"string\">&quot;com.android.mms&quot;</span>,<span class=\"string\">&quot;com.android.mms.ui.ConversationList&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n<li>跳到编辑短信界面<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent intent = <span class=\"keyword\">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class=\"line\">intent.setType(<span class=\"string\">&quot;vnd.android-dir/mms-sms&quot;</span>);</span><br><span class=\"line\">startActivity(intent);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"intent中的各种flag\">Intent中的各种FLAG<a title=\"#intent中的各种flag\" href=\"#intent中的各种flag\"></a></h2>\n<ol>\n<li>FLAG_ACTIVITY_BROUGHT_TO_FRONT<br>\n如果通过该Flag启动的Activity已经存在，下次再次启动，将只是把该Activity带到前台。假如A启动B时设置该标签，B又启动C,C又启动B（正常启动），最终栈内的实例是A，C，B。</li>\n<li>FLAG_ACTIVITY_CLEAR_TOP<br>\n相当于启动模式的singleTask。假设启动B时设置此标记，例如栈中现在是A,B,C,D那么再次启动B后的结果是A，B。</li>\n<li>FLAG_ACTIVITY_NEW_TASK<br>\n启动一个新的栈来存储启动这个activity。</li>\n<li>FLAG_ACTIVITY_NO_ANIMATION<br>\n启动Activity时不使用过渡动画</li>\n<li>FLAG_ACTIVITY_NO_HISTORY<br>\n被启动的Activity将不会记录在栈的历史中，假设启动D设置了此标记，例如之前栈中有A,B,C，现在C启动D，然后在由D启动E，那么此时栈中存在的实例有A，B，C，E.</li>\n<li>FLAG_ACTIVITY_REORDER_TO_FRONT<br>\n假如当前栈中已经存在所启动的Activity, 例如当前栈内有A，B，C。此时由 C通过该标记启动B,那么最终栈内的顺序是A，C，B。</li>\n<li>FLAG_ACTIVITY_SINGLE_TOP<br>\n相当于启动模式的singleTop。假设启动B时设置此标记，例如栈中现在是A，B，那么再次启动B后的结果还是A，B。假如栈中现在是A，B，C，启动B，则是A，B，C，B。</li>\n</ol>\n<p>至于其他FLAG并不常用，真正用到时请搬梯子查阅官方intent的Api：<br>\n<a href=\"https://developer.android.com/reference/android/content/Intent.html\">https://developer.android.com/reference/android/content/Intent.html</a></p>\n","prev":{"title":"Java开发揭开socket编程的面纱","link":"post/1472485045"},"next":{"title":"Android开发之进程间通信AIDL的探究和学习","link":"post/1469856029"},"plink":"https://blog.ixin.run/post/1470031654/","toc":[{"id":"什么是intent","title":"什么是Intent","index":"1"},{"id":"intent&amp;intentfilter属性","title":"Intent&amp;IntentFilter属性","index":"2"},{"id":"意图分类","title":"意图分类","index":"3","children":[{"id":"显式intent","title":"显式Intent","index":"3.1"},{"id":"隐式intent","title":"隐式Intent","index":"3.2"}]},{"id":"intent使用","title":"Intent使用","index":"4"},{"id":"intent调用系统组件使用例子","title":"Intent调用系统组件使用例子","index":"5"},{"id":"intent中的各种flag","title":"Intent中的各种FLAG","index":"6"}],"reward":true,"copyright":{"custom":"转载请注明出处，谢谢支持。"}}