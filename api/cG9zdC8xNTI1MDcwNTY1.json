{"title":"TextView局部字体超链接处理方案","date":"2018-04-30T06:42:45.000Z","date_formatted":{"ll":"2018年4月30日","L":"2018/04/30","MM-DD":"04-30"},"link":"post/1525070565","comments":true,"categories":["Android"],"updated":"2021-01-14T08:08:54.907Z","content":"<p>还是之前的老项目问题，应法务部门的要求要将之前客户端的相关条款调整一下，每条内容中还有多个条款可方便用户进行点击查看详细内容，本来没啥问题，当去寻找内容所在的时候却发现都是在本地配置的，并且是xml写死的，而且对于TextView中的条款却是采用多个TextView进行组合而成的。擦类，对于产品的要求要多种情况进行变换，还要调整大小屏，在我的思想里这…必须要换了。</p>\n<a id=\"more\"></a>\n<h2 id=\"问题及解决方案\">问题及解决方案<a title=\"#问题及解决方案\" href=\"#问题及解决方案\"></a></h2>\n<p>针对文本TextVieww中含有多个不同的样式子串或者文本中含有多个超链接的问题其实解决方案还是挺多的。这里就列举几个：</p>\n<ul>\n<li>采用html标签对文本多样化设计。</li>\n<li>采用在xml文件中配置autoLink属性。</li>\n<li>采用SpannableStringBuilder进行多样化设置。</li>\n</ul>\n<h2 id=\"1.采用html标签对文本多样化设计\">1.采用html标签对文本多样化设计<a title=\"#1.采用html标签对文本多样化设计\" href=\"#1.采用html标签对文本多样化设计\"></a></h2>\n<p>在代码中可直接采用Html.fromHtml():</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TextView test_tv = findViewById(R.id.test_tv);</span><br><span class=\"line\">test_tv.setText(Html.fromHtml(<span class=\"string\">&quot;&lt;a href=\\&quot;http://www.baidu.com/\\&quot;&gt;地瓜地瓜这里是百度&lt;/a&gt;&quot;</span>));</span><br></pre></td></tr></table></figure>\n<p>还可以直接在xml布局中设置，不过html要写在资源文件String里面。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;TextView</span><br><span class=\"line\">    android:id=&quot;@+id/test_tv&quot;</span><br><span class=\"line\">    android:layout_width=&quot;wrap_content&quot;</span><br><span class=\"line\">    android:layout_height=&quot;wrap_content&quot;</span><br><span class=\"line\">    android:text=&quot;@string/linktext&quot;</span><br><span class=\"line\">    /&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">string</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;app_name&quot;</span>&gt;</span>My Application<span class=\"tag\">&lt;/<span class=\"name\">string</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">string</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;linktext&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;http://www.baidu.com/&quot;</span>&gt;</span>地瓜地瓜这里是百度<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">string</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span> </span><br></pre></td></tr></table></figure>\n<p>此时点击超链接其实并不起作用，我们还要加上一句话才能跳转到系统浏览器里面：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">textView.setMovementMethod(LinkMovementMethod.getInstance());</span><br></pre></td></tr></table></figure>\n<p>但是有些时候我们想跳转到自己应用中的webview中怎么办呢？<br>\n所以我们要进行超链接拦截：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test_tv = findViewById(R.id.test_tv);</span><br><span class=\"line\">CharSequence charSequence = Html.fromHtml(<span class=\"string\">&quot;地瓜地瓜这里是&lt;a href=\\&quot;http://www.baidu.com/\\&quot;&gt;百度&lt;/a&gt;&quot;</span>);</span><br><span class=\"line\">SpannableStringBuilder builder = <span class=\"keyword\">new</span> SpannableStringBuilder(charSequence);</span><br><span class=\"line\">URLSpan[] urlSpans = builder.getSpans(<span class=\"number\">0</span>, charSequence.length(), URLSpan.class);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (URLSpan span : urlSpans) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> start = builder.getSpanStart(span);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> end = builder.getSpanEnd(span);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> flag = builder.getSpanFlags(span);</span><br><span class=\"line\">    <span class=\"keyword\">final</span> String link = span.getURL();</span><br><span class=\"line\">    builder.removeSpan(span); <span class=\"comment\">//移除默认的urlspan，去除优先跳到系统默认浏览器而使得拦截失效。</span></span><br><span class=\"line\">    builder.setSpan(<span class=\"keyword\">new</span> ClickableSpan() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View widget)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 捕获&lt;a&gt;标签点击事件，及对应超链接link，可在这里做跳转。</span></span><br><span class=\"line\">            Toast.makeText(MainActivity.<span class=\"keyword\">this</span>, <span class=\"string\">&quot;你点击的URL是&quot;</span> + link, Toast.LENGTH_SHORT).show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;, start, end, flag);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">test_tv.setLinksClickable(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">test_tv.setMovementMethod(LinkMovementMethod.getInstance());</span><br><span class=\"line\">test_tv.setText(builder);</span><br></pre></td></tr></table></figure>\n<p>以下是收录的一些TextView可以使用的Html标签：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">标签      说明  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>        插入一个换行符。</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>        标签是空标签（意味着它没有结束标签，因此这是错误的：<span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">br</span>&gt;</span>）    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>         定义段落。</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>         标签会自动在其前后各添加一个空行    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>        定义最大的标题</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>        ↓</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>        ↓</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>        ↓</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h5</span>&gt;</span>        ↓</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h6</span>&gt;</span>        定义最小的标题</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>       文档分节    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>    把文本定义为语气更强的强调的内容。TextView中表现为文本加粗   </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">b</span>&gt;</span>         文本加粗    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">em</span>&gt;</span>        把文本定义为强调的内容。TextView中表现为斜体文本效果。 </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">cite</span>&gt;</span>      定义引用。TextView中表现为斜体文本效果。    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dfn</span>&gt;</span>       标记那些对特殊术语或短语的定义。TextView中表现为斜体文本效果。 </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">i</span>&gt;</span>         显示斜体文本效果。   </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">big</span>&gt;</span>       呈现大号字体效果    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">small</span>&gt;</span>     呈现小号字体效果    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">strike</span>&gt;</span>    定义删除线样式的文字</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">font</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;...&quot;</span> <span class=\"attr\">color</span>=<span class=\"string\">&quot;...&quot;</span> <span class=\"attr\">face</span>=<span class=\"string\">&quot;...&quot;</span>&gt;</span>    规定文本的字体、字体尺寸、字体颜色   color：文本颜色；size：文本大小；face：文本字体</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">blockquote</span>&gt;</span>    将<span class=\"tag\">&lt;<span class=\"name\">blockquote</span>&gt;</span> 与 <span class=\"tag\">&lt;/<span class=\"name\">blockquote</span>&gt;</span> 之间的文本从常规文本中分离出来。</span><br><span class=\"line\">通常在左、右两边进行缩进，有时使用斜体。    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tt</span>&gt;</span>        呈现类似打字机或者等宽的文本效果    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span>&gt;</span>         定义超链接。最重要的属性是 href 属性，它指示链接的目标。 href：指示链接的目标</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">u</span>&gt;</span>         为文本添加下划线    </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sup</span>&gt;</span>       定义上标文本  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">sub</span>&gt;</span>       定义下标文本  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;...&quot;</span>&gt;</span> 向网页中嵌入一幅图像。<span class=\"tag\">&lt;<span class=\"name\">img</span>&gt;</span>标签并不会在网页中插入图像，而是从网页上链接图像。<span class=\"tag\">&lt;<span class=\"name\">img</span>&gt;</span>  标签创建的是被引用图像的占位空间。   src：图像的url；alt：图像的替代文本</span><br></pre></td></tr></table></figure>\n<h2 id=\"2.采用在xml文件中配置autolink属性\">2.采用在xml文件中配置autoLink属性<a title=\"#2.采用在xml文件中配置autolink属性\" href=\"#2.采用在xml文件中配置autolink属性\"></a></h2>\n<p>TextView有一个叫做autoLink的属性可以将符合指定格式的文本转换为可单击的超链接形式，在帮助文档中也可以发现Android给我们提供了如下几种格式：</p>\n<ol>\n<li>none：表示不进行任何匹配，默认；</li>\n<li>web：表示匹配web网址，例如http://www.baidu.com；</li>\n<li>email：表示匹配邮件地址；</li>\n<li>phone：表示匹配电话号码；</li>\n<li>map：表示匹配地图地址,一般针对google地图；</li>\n<li>all：表示将会匹配web、email、phone、map；</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;TextView</span><br><span class=\"line\">    android:layout_width=&quot;wrap_content&quot;</span><br><span class=\"line\">    android:layout_height=&quot;wrap_content&quot;</span><br><span class=\"line\">    android:text=&quot;百度的网址是:http://www.baidu.com&quot;</span><br><span class=\"line\">    android:autoLink=&quot;web&quot;</span><br><span class=\"line\">    /&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"3.采用spannablestring进行多样化设置\">3.采用SpannableString进行多样化设置<a title=\"#3.采用spannablestring进行多样化设置\" href=\"#3.采用spannablestring进行多样化设置\"></a></h2>\n<p>以上是文本中含有超链接地址，开发过程中更多的是后台单独给我传递局部字体的超链接地址，移动端除了单独设置超链接还要调节这些局部字体的大小、颜色等样式，因为原文本中不含超链接地址，所以我们也不用移除原有的span了。这里我们采用SpannableStringBuilder来进行多样化设置。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 设置超链接</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> tv</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">settingLink</span><span class=\"params\">(TextView tv)</span> </span>&#123;</span><br><span class=\"line\">    String content = tv.getText().toString();</span><br><span class=\"line\">    String link = <span class=\"string\">&quot;百度&quot;</span>;</span><br><span class=\"line\">    String linkUrl = <span class=\"string\">&quot;http://www.baidu.com&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (content.indexOf(link) == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> start = content.indexOf(link);</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> end = start + link.length();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> flag = Spanned.SPAN_EXCLUSIVE_EXCLUSIVE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//构建SpannableStringBuilder</span></span><br><span class=\"line\">    SpannableStringBuilder builder = <span class=\"keyword\">new</span> SpannableStringBuilder(content);</span><br><span class=\"line\">    <span class=\"comment\">//设置文字的单击事件</span></span><br><span class=\"line\">    builder.setSpan(<span class=\"keyword\">new</span> CustomUrlSpan(<span class=\"keyword\">this</span>, linkUrl), start, end, flag);</span><br><span class=\"line\">    <span class=\"comment\">//设置文字的前景色</span></span><br><span class=\"line\">    builder.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(Color.RED), start, end, flag);</span><br><span class=\"line\"></span><br><span class=\"line\">    tv.setLinksClickable(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    tv.setMovementMethod(LinkMovementMethod.getInstance());</span><br><span class=\"line\">    tv.setText(builder);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>默认情况下超链接部分都有一条下划线，为了美观性必要情况下我们要将下划线去掉，所以可以设置匿名内部类ClickableSpan扩充updateDrawState方法处理，这里为了程序功能发展性和模块化单独自定义个内部类继承ClickableSpan做处理：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 自定义ClickableSpan内部类，单独对点击事件处理</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomUrlSpan</span> <span class=\"keyword\">extends</span> <span class=\"title\">ClickableSpan</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Context context;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String url;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomUrlSpan</span><span class=\"params\">(Context context, String url)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.context = context;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.url = url;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View widget)</span> </span>&#123;</span><br><span class=\"line\">        Intent intent = <span class=\"keyword\">new</span> Intent(context, WebViewActivity.class);</span><br><span class=\"line\">        intent.putExtra(WebViewActivity.WEB_URL, url);</span><br><span class=\"line\">        context.startActivity(intent);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateDrawState</span><span class=\"params\">(TextPaint ds)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.updateDrawState(ds);</span><br><span class=\"line\">        <span class=\"comment\">//去除超链接下划线</span></span><br><span class=\"line\">        ds.setUnderlineText(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>SpannableStringBuilder有个亲兄弟——SpannableString。是不是觉得有点熟悉？相信大部分童鞋之前也用过这个。SpannableStringBuilder和SpannableString的区别类似与StringBuilder、String，就是SpannableStringBuilder可以拼接，而SpannableString不可拼接。</p>\n<p>SpannableStringBuilder和SpannableString主要通过使用setSpan(Object what, int start, int end, int flags)改变文本样式，上边的实例主要用的就是这个方法。<br>\n对应的参数：</p>\n<ul>\n<li>\n<p>start： 指定Span的开始位置。</p>\n</li>\n<li>\n<p>end： 指定Span的结束位置，并不包括这个位置。</p>\n</li>\n<li>\n<p>flags：取值有如下四个：</p>\n<ul>\n<li>Spannable.SPAN_EXCLUSIVE_INCLUSIVE：开始坐标不包括，结束坐标包括。</li>\n<li>Spannable.SPAN_INCLUSIVE_EXCLUSIVE：开始坐标包括，结束坐标不包括。</li>\n<li>Spannable.SPAN_INCUJSIVE_INCLUSIVE：开始和结束坐标都包括。</li>\n<li>Spannable.SPAN_EXCLUSIVE_EXCLUSIVE：开始和结束坐标都不包括。</li>\n</ul>\n</li>\n<li>\n<p>what： 对应的各种Span，不同的Span对应不同的样式。已知的可用类有：</p>\n<ul>\n<li>BackgroundColorSpan : 文本背景色</li>\n<li>ForegroundColorSpan : 文本颜色</li>\n<li>MaskFilterSpan : 修饰效果，如模糊(BlurMaskFilter)浮雕</li>\n<li>RasterizerSpan : 光栅效果</li>\n<li>StrikethroughSpan : 删除线</li>\n<li>SuggestionSpan : 相当于占位符</li>\n<li>UnderlineSpan : 下划线</li>\n<li>AbsoluteSizeSpan : 文本字体（绝对大小）</li>\n<li>DynamicDrawableSpan : 设置图片，基于文本基线或底部对齐</li>\n<li>ImageSpan : 图片</li>\n<li>RelativeSizeSpan : 相对大小（文本字体）</li>\n<li>ScaleXSpan : 基于x轴缩放</li>\n<li>StyleSpan : 字体样式：粗体、斜体等</li>\n<li>SubscriptSpan : 下标（数学公式会用到）</li>\n<li>SuperscriptSpan : 上标（数学公式会用到）</li>\n<li>TextAppearanceSpan : 文本外貌（包括字体、大小、样式和颜色）</li>\n<li>TypefaceSpan : 文本字体</li>\n<li>URLSpan : 文本超链接</li>\n<li>ClickableSpan : 点击事件</li>\n</ul>\n</li>\n</ul>\n<p>感谢<a href=\"https://www.jianshu.com/p/960467ac56c8\" target=\"_blank\">Blankj</a>童鞋将SpannableStringBuilder完美封装成一个工具类，大家可以根据需求进行参考：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SpannableStringUtils</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">SpannableStringUtils</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> UnsupportedOperationException(<span class=\"string\">&quot;u can&#x27;t instantiate me...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取建造者 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Builder <span class=\"title\">getBuilder</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> CharSequence text)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Builder(text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Builder</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> defaultValue = <span class=\"number\">0x12000000</span>;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> CharSequence text;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> flag;</span><br><span class=\"line\">        <span class=\"meta\">@ColorInt</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> foregroundColor;</span><br><span class=\"line\">        <span class=\"meta\">@ColorInt</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> backgroundColor;</span><br><span class=\"line\">        <span class=\"meta\">@ColorInt</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> quoteColor;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isLeadingMargin;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> first;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> rest;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isBullet;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> gapWidth;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> bulletColor;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> proportion;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> xProportion;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isStrikethrough;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isUnderline;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isSuperscript;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isSubscript;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isBold;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isItalic;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isBoldItalic;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> String fontFamily;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Alignment align;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> imageIsBitmap;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Bitmap bitmap;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> imageIsDrawable;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Drawable drawable;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> imageIsUri;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Uri uri;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> imageIsResourceId;</span><br><span class=\"line\">        <span class=\"meta\">@DrawableRes</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> resourceId;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> ClickableSpan clickSpan;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> String url;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> isBlur;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> radius;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> Blur style;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> SpannableStringBuilder mBuilder;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Builder</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> CharSequence text)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.text = text;</span><br><span class=\"line\">            flag = Spanned.SPAN_EXCLUSIVE_EXCLUSIVE;</span><br><span class=\"line\">            foregroundColor = defaultValue;</span><br><span class=\"line\">            backgroundColor = defaultValue;</span><br><span class=\"line\">            quoteColor = defaultValue;</span><br><span class=\"line\">            proportion = -<span class=\"number\">1</span>;</span><br><span class=\"line\">            xProportion = -<span class=\"number\">1</span>;</span><br><span class=\"line\">            mBuilder = <span class=\"keyword\">new</span> SpannableStringBuilder();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置标识 * * <span class=\"doctag\">@param</span> flag &lt;ul&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Spanned#SPAN_INCLUSIVE_EXCLUSIVE&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Spanned#SPAN_INCLUSIVE_INCLUSIVE&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Spanned#SPAN_EXCLUSIVE_EXCLUSIVE&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Spanned#SPAN_EXCLUSIVE_INCLUSIVE&#125;&lt;/li&gt; * &lt;/ul&gt; * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setFlag</span><span class=\"params\">(<span class=\"keyword\">int</span> flag)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.flag = flag;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置前景色 * * <span class=\"doctag\">@param</span> color 前景色 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setForegroundColor</span><span class=\"params\">(<span class=\"meta\">@ColorInt</span> <span class=\"keyword\">int</span> color)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.foregroundColor = color;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置背景色 * * <span class=\"doctag\">@param</span> color 背景色 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBackgroundColor</span><span class=\"params\">(<span class=\"meta\">@ColorInt</span> <span class=\"keyword\">int</span> color)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.backgroundColor = color;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置引用线的颜色 * * <span class=\"doctag\">@param</span> color 引用线的颜色 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setQuoteColor</span><span class=\"params\">(<span class=\"meta\">@ColorInt</span> <span class=\"keyword\">int</span> color)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.quoteColor = color;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置缩进 * * <span class=\"doctag\">@param</span> first 首行缩进 * <span class=\"doctag\">@param</span> rest 剩余行缩进 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setLeadingMargin</span><span class=\"params\">(<span class=\"keyword\">int</span> first, <span class=\"keyword\">int</span> rest)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.first = first;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.rest = rest;</span><br><span class=\"line\">            isLeadingMargin = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置列表标记 * * <span class=\"doctag\">@param</span> gapWidth 列表标记和文字间距离 * <span class=\"doctag\">@param</span> color 列表标记的颜色 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBullet</span><span class=\"params\">(<span class=\"keyword\">int</span> gapWidth, <span class=\"keyword\">int</span> color)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.gapWidth = gapWidth;</span><br><span class=\"line\">            bulletColor = color;</span><br><span class=\"line\">            isBullet = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置字体比例 * * <span class=\"doctag\">@param</span> proportion 比例 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setProportion</span><span class=\"params\">(<span class=\"keyword\">float</span> proportion)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.proportion = proportion;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置字体横向比例 * * <span class=\"doctag\">@param</span> proportion 比例 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setXProportion</span><span class=\"params\">(<span class=\"keyword\">float</span> proportion)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.xProportion = proportion;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置删除线 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setStrikethrough</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.isStrikethrough = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置下划线 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setUnderline</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.isUnderline = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置上标 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setSuperscript</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.isSuperscript = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置下标 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setSubscript</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.isSubscript = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置粗体 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBold</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            isBold = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置斜体 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setItalic</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            isItalic = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置粗斜体 * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBoldItalic</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            isBoldItalic = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置字体 * * <span class=\"doctag\">@param</span> fontFamily 字体 * &lt;ul&gt; * &lt;li&gt;monospace&lt;/li&gt; * &lt;li&gt;serif&lt;/li&gt; * &lt;li&gt;sans-serif&lt;/li&gt; * &lt;/ul&gt; * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setFontFamily</span><span class=\"params\">(<span class=\"meta\">@Nullable</span> String fontFamily)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.fontFamily = fontFamily;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置对齐 * &lt;ul&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Alignment#ALIGN_NORMAL&#125;正常&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Alignment#ALIGN_OPPOSITE&#125;相反&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Alignment#ALIGN_CENTER&#125;居中&lt;/li&gt; * &lt;/ul&gt; * * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setAlign</span><span class=\"params\">(<span class=\"meta\">@Nullable</span> Alignment align)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.align = align;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置图片 * * <span class=\"doctag\">@param</span> bitmap 图片位图 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBitmap</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> Bitmap bitmap)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.bitmap = bitmap;</span><br><span class=\"line\">            imageIsBitmap = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置图片 * * <span class=\"doctag\">@param</span> drawable 图片资源 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setDrawable</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> Drawable drawable)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.drawable = drawable;</span><br><span class=\"line\">            imageIsDrawable = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置图片 * * <span class=\"doctag\">@param</span> uri 图片uri * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setUri</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> Uri uri)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.uri = uri;</span><br><span class=\"line\">            imageIsUri = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置图片 * * <span class=\"doctag\">@param</span> resourceId 图片资源id * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setResourceId</span><span class=\"params\">(<span class=\"meta\">@DrawableRes</span> <span class=\"keyword\">int</span> resourceId)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.resourceId = resourceId;</span><br><span class=\"line\">            imageIsResourceId = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置点击事件 * &lt;p&gt;需添加view.setMovementMethod(LinkMovementMethod.getInstance())&lt;/p&gt; * <span class=\"doctag\">@param</span> clickSpan 点击事件 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setClickSpan</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> ClickableSpan clickSpan)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.clickSpan = clickSpan;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置超链接 * &lt;p&gt;需添加view.setMovementMethod(LinkMovementMethod.getInstance())&lt;/p&gt; * * <span class=\"doctag\">@param</span> url 超链接 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setUrl</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> String url)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.url = url;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置模糊 * &lt;p&gt;尚存bug，其他地方存在相同的字体的话，相同字体出现在之前的话那么就不会模糊，出现在之后的话那会一起模糊&lt;/p&gt; * &lt;p&gt;推荐还是把所有字体都模糊这样使用&lt;/p&gt; * * <span class=\"doctag\">@param</span> radius 模糊半径（需大于0） * <span class=\"doctag\">@param</span> style 模糊样式&lt;ul&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Blur#NORMAL&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Blur#SOLID&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Blur#OUTER&#125;&lt;/li&gt; * &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Blur#INNER&#125;&lt;/li&gt; * &lt;/ul&gt; * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">setBlur</span><span class=\"params\">(<span class=\"keyword\">float</span> radius, Blur style)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.radius = radius;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.style = style;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.isBlur = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 追加样式字符串 * * <span class=\"doctag\">@param</span> text 样式字符串文本 * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@link</span> Builder&#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> Builder <span class=\"title\">append</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> CharSequence text)</span> </span>&#123;</span><br><span class=\"line\">            setSpan();</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.text = text;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 创建样式字符串 * * <span class=\"doctag\">@return</span> 样式字符串</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> SpannableStringBuilder <span class=\"title\">create</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            setSpan();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> mBuilder;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 设置样式</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setSpan</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> start = mBuilder.length();</span><br><span class=\"line\">            mBuilder.append(<span class=\"keyword\">this</span>.text);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> end = mBuilder.length();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (foregroundColor != defaultValue) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(foregroundColor), start, end, flag);</span><br><span class=\"line\">                foregroundColor = defaultValue;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (backgroundColor != defaultValue) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> BackgroundColorSpan(backgroundColor), start, end, flag);</span><br><span class=\"line\">                backgroundColor = defaultValue;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isLeadingMargin) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> LeadingMarginSpan.Standard(first, rest), start, end, flag);</span><br><span class=\"line\">                isLeadingMargin = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (quoteColor != defaultValue) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> QuoteSpan(quoteColor), start, end, <span class=\"number\">0</span>);</span><br><span class=\"line\">                quoteColor = defaultValue;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isBullet) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> BulletSpan(gapWidth, bulletColor), start, end, <span class=\"number\">0</span>);</span><br><span class=\"line\">                isBullet = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (proportion != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> RelativeSizeSpan(proportion), start, end, flag);</span><br><span class=\"line\">                proportion = -<span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (xProportion != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> ScaleXSpan(xProportion), start, end, flag);</span><br><span class=\"line\">                xProportion = -<span class=\"number\">1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isStrikethrough) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> StrikethroughSpan(), start, end, flag);</span><br><span class=\"line\">                isStrikethrough = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isUnderline) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> UnderlineSpan(), start, end, flag);</span><br><span class=\"line\">                isUnderline = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isSuperscript) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> SuperscriptSpan(), start, end, flag);</span><br><span class=\"line\">                isSuperscript = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isSubscript) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> SubscriptSpan(), start, end, flag);</span><br><span class=\"line\">                isSubscript = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isBold) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> StyleSpan(Typeface.BOLD), start, end, flag);</span><br><span class=\"line\">                isBold = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isItalic) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> StyleSpan(Typeface.ITALIC), start, end, flag);</span><br><span class=\"line\">                isItalic = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isBoldItalic) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> StyleSpan(Typeface.BOLD_ITALIC), start, end, flag);</span><br><span class=\"line\">                isBoldItalic = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (fontFamily != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> TypefaceSpan(fontFamily), start, end, flag);</span><br><span class=\"line\">                fontFamily = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (align != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> AlignmentSpan.Standard(align), start, end, flag);</span><br><span class=\"line\">                align = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (imageIsBitmap || imageIsDrawable || imageIsUri || imageIsResourceId) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (imageIsBitmap) &#123;</span><br><span class=\"line\">                    mBuilder.setSpan(<span class=\"keyword\">new</span> ImageSpan(Utils.context, bitmap), start, end, flag);</span><br><span class=\"line\">                    bitmap = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    imageIsBitmap = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (imageIsDrawable) &#123;</span><br><span class=\"line\">                    mBuilder.setSpan(<span class=\"keyword\">new</span> ImageSpan(drawable), start, end, flag);</span><br><span class=\"line\">                    drawable = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    imageIsDrawable = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (imageIsUri) &#123;</span><br><span class=\"line\">                    mBuilder.setSpan(<span class=\"keyword\">new</span> ImageSpan(Utils.context, uri), start, end, flag);</span><br><span class=\"line\">                    uri = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    imageIsUri = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    mBuilder.setSpan(<span class=\"keyword\">new</span> ImageSpan(Utils.context, resourceId), start, end, flag);</span><br><span class=\"line\">                    resourceId = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    imageIsResourceId = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (clickSpan != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(clickSpan, start, end, flag);</span><br><span class=\"line\">                clickSpan = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (url != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> URLSpan(url), start, end, flag);</span><br><span class=\"line\">                url = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isBlur) &#123;</span><br><span class=\"line\">                mBuilder.setSpan(<span class=\"keyword\">new</span> MaskFilterSpan(<span class=\"keyword\">new</span> BlurMaskFilter(radius, style)), start, end, flag);</span><br><span class=\"line\">                isBlur = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            flag = Spanned.SPAN_EXCLUSIVE_EXCLUSIVE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Android项目中Git忽略文件.gitignore的写法","link":"post/1525445463"},"next":{"title":"Android屏幕适配解决方案","link":"post/1522163597"},"plink":"https://blog.ixin.run/post/1525070565/","toc":[{"id":"问题及解决方案","title":"问题及解决方案","index":"1"},{"id":"1.采用html标签对文本多样化设计","title":"1.采用html标签对文本多样化设计","index":"2"},{"id":"2.采用在xml文件中配置autolink属性","title":"2.采用在xml文件中配置autoLink属性","index":"3"},{"id":"3.采用spannablestring进行多样化设置","title":"3.采用SpannableString进行多样化设置","index":"4"}],"reward":true,"copyright":{"custom":"转载请注明出处，谢谢支持。"}}