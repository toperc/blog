{"title":"Android开发View坐标了解","date":"2018-11-15T16:05:19.000Z","date_formatted":{"ll":"2018年11月16日","L":"2018/11/16","MM-DD":"11-16"},"link":"post/1542297919","comments":true,"tags":["View视图"],"categories":["Android"],"updated":"2021-01-14T08:08:54.897Z","content":"<p>Android开发过程中，针对View视图坐标系必要时获取坐标，其重要性不言而喻。坐标系分为屏幕坐标系和View视图坐标系，前者用于真实坐标，后者用于获取相对坐标和宽高。</p>\n<a id=\"more\"></a>\n<h2 id=\"android视图坐标系\">Android视图坐标系<a title=\"#android视图坐标系\" href=\"#android视图坐标系\"></a></h2>\n<p>android中的坐标系有两种：一种是Android坐标系，是相对屏幕原点来说的，也可以叫绝对坐标；另外一种是视图坐标系，是根据当前view以及父布局来说的。</p>\n<h3 id=\"android坐标系\">Android坐标系<a title=\"#android坐标系\" href=\"#android坐标系\"></a></h3>\n<p><img src=\"https://note.youdao.com/yws/api/personal/file/B92D25BEF8F24F7F8CBA598D3BE23D13?method=download&amp;shareKey=50af943943e4a335d0959a30e4fb1591\" alt=\"android坐标系\"><br>\n以屏幕左上角原点为中心，x轴向右为正，y轴向下为正。</p>\n<h3 id=\"视图坐标系\">视图坐标系<a title=\"#视图坐标系\" href=\"#视图坐标系\"></a></h3>\n<p><img src=\"https://note.youdao.com/yws/api/personal/file/CDCE7DFB97624B4EBF91AD85A3E3C2BA?method=download&amp;shareKey=762ec86127d2a43bb5a405dbb16a1344\" alt=\"视图坐标系\"><br>\n根据view自身相关属性计算view所处坐标。</p>\n<p><strong>View获取自身宽高</strong></p>\n<ul>\n<li>getHeight()：获取View自身高度</li>\n<li>getWidth()：获取View自身宽度</li>\n</ul>\n<p><strong>View自身坐标</strong></p>\n<p>通过如下方法可以获得View到其父控件（ViewGroup）的距离：</p>\n<ul>\n<li>getTop()：获取View自身顶边到其父布局顶边的距离</li>\n<li>getLeft()：获取View自身左边到其父布局左边的距离</li>\n<li>getRight()：获取View自身右边到其父布局左边的距离</li>\n<li>getBottom()：获取View自身底边到其父布局顶边的距离</li>\n</ul>\n<p><strong>MotionEvent提供的方法</strong></p>\n<p>我们看上图那个深蓝色的点，假设就是我们触摸的点，我们知道无论是View还是ViewGroup，最终的点击事件都会由onTouchEvent(MotionEventevent)方法来处理，MotionEvent也提供了各种获取焦点坐标的方法：</p>\n<ul>\n<li>getX()：获取点击事件距离控件左边的距离，即视图坐标</li>\n<li>getY()：获取点击事件距离控件顶边的距离，即视图坐标</li>\n<li>getRawX()：获取点击事件距离整个屏幕左边距离，即绝对坐标</li>\n<li>getRawY()：获取点击事件距离整个屏幕顶边的的距离，即绝对坐标</li>\n</ul>\n<h2 id=\"几个问题\">几个问题<a title=\"#几个问题\" href=\"#几个问题\"></a></h2>\n<ul>\n<li>View 的 getＹ()， getTranslationY() 和 getTop() 之间的联系；</li>\n<li>View 的 scrollTo() 和 scrollBy()；</li>\n</ul>\n<p>View的getY()，getTranslationY()和getTop()之间的联系：<br>\n<code>getY() = getTranslationY()+ getTop();</code></p>\n<p>getTranslationY()：竖直方向上相对于top的偏移量，默认值为0；</p>\n<p>scrollTo()和scrollBy()从字面意思我们可以知道scrollTo()是滑动到哪里的意思 ，scrollBy()是相对当前的位置滑动了多少。</p>\n<p>需注意：scrollTo和scrollBy函数的参数和坐标系是“相反的”，比如 scrollTo(-100,0)，View 的内容是向X轴正方向移动的。</p>\n<h2 id=\"view坐标获取时机\">view坐标获取时机<a title=\"#view坐标获取时机\" href=\"#view坐标获取时机\"></a></h2>\n<p>一般来说，我们要获取View的坐标和高度等，都必须等到View绘制完毕以后才能获取的到，在Activity的onCreate()方法里面是获取不到的，必须等到 View绘制完毕以后才能获取地到View的响应的坐标，一般来说，主要有以下两种方法。</p>\n<p><strong>第一种方法，onWindowFocusChanged()方法里面进行调用</strong><br>\n因为onWindowFocusChanged可能会调用多次，所以我们可以用一个唯一标识来控制获取坐标调用一次即可。</p>\n<p><strong>第二种方法,在视图树绘制完成的时候进行测量</strong><br>\n利用view.getViewTreeObserver().addOnGlobalLayoutListener监听view是否整个绘制完毕，然后进行获取坐标。</p>\n<h2 id=\"参考\">参考<a title=\"#参考\" href=\"#参考\"></a></h2>\n<ul>\n<li><a href=\"https://blog.csdn.net/itachi85/article/details/50708391\">https://blog.csdn.net/itachi85/article/details/50708391</a></li>\n<li><a href=\"https://juejin.im/entry/5880209c2f301e006968a342\">https://juejin.im/entry/5880209c2f301e006968a342</a></li>\n</ul>\n","prev":{"title":"那些年Android保活的奇技淫巧","link":"post/1542901406"},"next":{"title":"AndroidStudio工程目录和项目资源文件介绍","link":"post/1536976596"},"plink":"https://blog.ixin.run/post/1542297919/","toc":[{"id":"android视图坐标系","title":"Android视图坐标系","index":"1","children":[{"id":"android坐标系","title":"Android坐标系","index":"1.1"},{"id":"视图坐标系","title":"视图坐标系","index":"1.2"}]},{"id":"几个问题","title":"几个问题","index":"2"},{"id":"view坐标获取时机","title":"view坐标获取时机","index":"3"},{"id":"参考","title":"参考","index":"4"}],"reward":true,"copyright":{"custom":"转载请注明出处，谢谢支持。"}}